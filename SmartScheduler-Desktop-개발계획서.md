# SmartScheduler Desktop App 개발 계획서

> Claude Code를 활용한 Tauri + React 기반 데스크톱 앱 개발 가이드

---

## 1. 프로젝트 개요

### 컨셉
2D 캐릭터 비서가 함께하는 개인 일정관리 앱. 자연어로 대화하면서 일정을 관리하고, 달력으로 일정을 확인할 수 있다.

### 핵심 특징
- 세로로 길쭉한 위젯 형태 (Mac 구석에 띄워두고 사용)
- 상단에 캐릭터가 상주하며 상태에 따라 애니메이션 변경
- 채팅/달력 모드 전환 가능
- 백엔드는 Discord API를 통해 기존 Mac 서버와 통신 (이미 구현됨)

### 기술 스택
- **프레임워크**: Tauri (Rust 기반 경량 데스크톱 앱)
- **프론트엔드**: React + TypeScript
- **스타일링**: CSS Modules 또는 Tailwind CSS
- **상태관리**: React Context 또는 Zustand (가벼운 상태관리)
- **통신**: Discord REST API (fetch 사용)

---

## 2. 화면 구조

### 전체 레이아웃 (3단 구조)

```
┌─────────────────────┐
│                     │
│    캐릭터 영역       │  ← 고정 높이, 16:9 비율
│                     │
├─────────────────────┤
│                     │
│                     │
│    컨텐츠 영역       │  ← 가변 높이, 스크롤 가능
│   (채팅 or 달력)     │
│                     │
│                     │
├─────────────────────┤
│  [■━━━] 채팅  달력   │  ← 고정 높이, 토글 스위치
└─────────────────────┘
```

### 창 속성
- 세로로 길쭉한 고정 크기 (예: 360 x 640)
- 리사이즈 비활성화 권장
- "항상 위에" 옵션 제공 (선택적)
- 타이틀바 커스텀 또는 숨김 고려

---

## 3. 캐릭터 시스템

### 상태 종류

| 상태 | 트리거 | 설명 |
|------|--------|------|
| `idle` | 기본 | 가만히 있으면서 미세하게 움직임 (숨쉬기 등) |
| `thinking` | 메시지 전송 후 응답 대기 중 | 고민하는 포즈 |
| `action` | 응답 수신 완료 | 어떤 동작 취하는 모습 |
| `looking_down` | 달력 모드 진입 | 화면 경계를 잡고 아래를 내려다봄 |

### 이미지 처리 방식
- 개발 단계: 상태명을 텍스트로 표시 (예: "[idle]", "[thinking]")
- 배포 단계: 상태별 GIF 또는 sprite sheet로 교체
- 이미지 파일 네이밍 규칙: `character_idle.gif`, `character_thinking.gif` 등

### 전환 로직
- 상태 변경 시 fade 또는 즉시 전환
- `thinking` → `action` → `idle` 자동 전환 (타이머 기반)
- 모드 전환(채팅↔달력)은 즉시 상태 변경

---

## 4. 채팅 모드

### 구성 요소
- 메시지 목록 영역 (스크롤 가능)
- 메시지 입력창 (하단 고정)
- 전송 버튼

### 메시지 타입
- **사용자 메시지**: 오른쪽 정렬, 구분되는 배경색
- **봇 응답**: 왼쪽 정렬, 다른 배경색
- **시스템 메시지**: 중앙 정렬, 회색 텍스트 (연결 상태 등)

### 동작 흐름
1. 사용자가 메시지 입력 후 전송
2. 캐릭터 상태 → `thinking`
3. Discord API로 메시지 전송
4. 서버 응답 수신 대기 (폴링 방식)
5. 응답 수신 시 캐릭터 상태 → `action`
6. 메시지 목록에 응답 추가
7. 일정 시간 후 캐릭터 상태 → `idle`

### 빠른 명령어 지원
입력창에서 `!` 로 시작하면 명령어로 인식. 자동완성 또는 힌트 표시 고려.
- `!today`, `!tomorrow`, `!week`, `!tasks` 등

---

## 5. 달력 모드

### 두 가지 뷰

#### 5-1. 월간 달력 (기본 뷰)
- 해당 월의 달력 그리드 표시
- 오늘 날짜 강조 (테두리 또는 배경색)
- 일정 있는 날짜에 점(dot) 표시
- 상단에 월 표시 + 이전/다음 월 이동 버튼
- 날짜 클릭 시 → 일간 시간표 뷰로 전환

#### 5-2. 일간 시간표 (상세 뷰)
- 선택한 날짜를 중심으로 3일 표시 (어제/오늘/내일)
- 가로 스와이프로 날짜 이동
- 세로축: 시간 (예: 06:00 ~ 24:00)
- 일정을 시간 블록으로 표시
- 상단에 [← 뒤로] 버튼 → 월간 달력으로 복귀

### 일정 블록 표시
- 카테고리별 색상 구분
  - 학업: 파랑
  - 약속: 초록
  - 개인: 보라
  - 업무: 주황
  - 루틴: 하늘색
  - 기타: 회색
- 블록에 제목 표시 (잘리면 말줄임)
- 블록 탭 시 상세 정보 표시 (모달 또는 툴팁)

---

## 6. 토글 스위치

### 디자인
- 좌우로 슬라이드하는 형태
- 현재 선택된 모드 쪽에 채워진 네모(■)
- 애니메이션으로 부드럽게 이동

### 동작
- 클릭 또는 드래그로 전환
- 전환 시 컨텐츠 영역 교체 (fade 또는 slide 애니메이션)
- 전환 시 캐릭터 상태도 변경 (`idle` ↔ `looking_down`)

---

## 7. Discord 통신 레이어

### 구조
- Discord REST API 직접 호출
- Bot Token을 사용한 인증
- 특정 채널에 메시지 송수신

### 필요한 API
- `POST /channels/{channel_id}/messages` - 메시지 전송
- `GET /channels/{channel_id}/messages` - 메시지 조회 (폴링)

### 메시지 수신 방식
- 주기적 폴링 (예: 1초 간격)
- 마지막으로 받은 메시지 ID 이후의 메시지만 조회
- 서버 봇의 메시지만 필터링하여 표시

### 설정 관리
- Bot Token, Channel ID는 설정 파일 또는 환경변수로 관리
- 첫 실행 시 설정 입력 화면 또는 설정 파일 안내

---

## 8. 데이터 관리

### 로컬 캐시 (선택적)
- 최근 대화 내역 저장 (앱 재시작 시 복원)
- 일정 데이터 캐시 (오프라인 달력 조회용)
- 저장소: localStorage 또는 Tauri의 fs API

### 서버 응답 파싱
- 서버 응답에서 일정 데이터 추출하는 로직 필요
- 정규식 또는 특정 포맷 파싱
- 파싱된 데이터로 달력 업데이트

---

## 9. 개발 순서

### Phase 1: 기본 틀 (뼈대)
1. Tauri + React 프로젝트 생성
2. 3단 레이아웃 구현 (캐릭터/컨텐츠/토글)
3. 토글 스위치로 채팅↔달력 전환
4. 캐릭터 상태 텍스트 표시

### Phase 2: 채팅 기능
5. 메시지 입력/표시 UI
6. Discord API 연동 (메시지 전송)
7. Discord API 폴링 (메시지 수신)
8. 캐릭터 상태 연동 (idle → thinking → action → idle)

### Phase 3: 달력 기능
9. 월간 달력 UI
10. 일간 시간표 UI (3일 뷰)
11. 스와이프 네비게이션
12. 더미 데이터로 일정 블록 표시

### Phase 4: 통합 및 마무리
13. 서버 응답 파싱 → 달력 데이터 연동
14. 로컬 캐시 구현
15. 설정 화면 (토큰, 채널 ID)
16. 창 속성 조정 (크기 고정, 항상 위 등)
17. 캐릭터 이미지 교체 준비 (플레이스홀더 → 실제 이미지)

---

## 10. 프로젝트 구조 제안

```
smart-scheduler/
├── src-tauri/          # Tauri (Rust) 설정
│   ├── tauri.conf.json # 창 크기, 타이틀 등 설정
│   └── ...
├── src/                # React 소스
│   ├── components/     # 컴포넌트
│   │   ├── Character/  # 캐릭터 영역
│   │   ├── Chat/       # 채팅 관련
│   │   ├── Calendar/   # 달력 관련
│   │   └── Toggle/     # 토글 스위치
│   ├── hooks/          # 커스텀 훅
│   │   ├── useDiscord.ts    # Discord 통신
│   │   └── useCharacter.ts  # 캐릭터 상태 관리
│   ├── styles/         # 스타일
│   ├── types/          # TypeScript 타입 정의
│   ├── App.tsx         # 메인 앱
│   └── main.tsx        # 엔트리포인트
├── assets/             # 이미지 등 정적 파일
│   └── character/      # 캐릭터 이미지 (나중에)
└── package.json
```

---

## 11. Claude Code 작업 시 참고사항

### 단계별 요청 예시
- "Tauri + React 프로젝트 초기 세팅해줘"
- "3단 레이아웃 컴포넌트 만들어줘"
- "채팅 모드 컴포넌트 구현해줘"
- "Discord API로 메시지 보내는 훅 만들어줘"

### 주의사항
- 한 번에 너무 많은 기능 요청하지 말고 단계별로
- 각 단계마다 동작 확인 후 다음 단계 진행
- 에러 발생 시 에러 메시지 전체 공유

### 테스트 방법
- `npm run tauri dev`로 개발 모드 실행
- 브라우저 개발자 도구로 React 디버깅
- Discord 메시지는 실제 Discord 채널에서 확인

---

## 12. 향후 확장 고려사항

- 알림 기능 (Tauri notification API)
- 시스템 트레이 상주
- 글로벌 단축키로 창 토글
- 위젯 크기 조절 옵션
- 다크/라이트 테마
- 캐릭터 커스터마이징 (여러 캐릭터 중 선택)

---

*이 계획서를 Claude Code에 제공하고 단계별로 개발을 진행하세요.*
